<!doctype html>
<html lang="sv">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>Inclinometer – 4 teman</title>
<style>
  html,body{height:100%;margin:0;font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text",system-ui,Segoe UI,Roboto,Arial,sans-serif;-webkit-font-smoothing:antialiased}
  .topbar{position:fixed;left:0;right:0;top:0;display:flex;gap:8px;align-items:center;justify-content:center;padding:10px;z-index:50}
  .pill{border-radius:999px;padding:8px 12px;font-size:12px;border:1px solid rgba(255,255,255,.15);backdrop-filter:saturate(1.6) blur(10px);cursor:pointer}
  .btn{border-radius:10px;padding:8px 12px;font-weight:600;border:0;cursor:pointer}
  .controls{position:fixed;left:10px;bottom:10px;display:flex;gap:8px;align-items:center;z-index:60}
  .hint{font-size:12px;opacity:.8}
  /* ---------- THEME 1: FREE (neon, diagonal, bar layout) ---------- */
  .t-free{--bg1:#0b0f14;--bg2:#0a0a0a;--fg:#e8f6ff;--muted:#9fb3c8;--green:#22d3ee;--warn:#facc15;--red:#ef4444;
          background:linear-gradient(135deg,var(--bg1),var(--bg2)); color:var(--fg);}
  .free-wrap{min-height:100%; display:grid; grid-template-rows:auto 1fr; padding-top:56px;}
  .free-main{display:grid; grid-template-columns:1fr 1fr; gap:20px; padding:20px}
  @media(max-width:900px){ .free-main{grid-template-columns:1fr} }
  .free-card{position:relative;border-radius:18px; padding:18px; background:linear-gradient(180deg,rgba(255,255,255,.08),rgba(255,255,255,.03)); border:1px solid rgba(255,255,255,.12); box-shadow:0 20px 60px rgba(0,0,0,.45), inset 0 1px 0 rgba(255,255,255,.06)}
  .free-title{font-size:12px;letter-spacing:.12em;opacity:.8;text-transform:uppercase;margin-bottom:8px}
  .barBox{position:relative;height:220px;border-radius:14px;background:radial-gradient(600px 400px at 50% 0%, #101826 0%, transparent 70%)}
  .hTrack{position:absolute;left:20px;right:20px;top:50%;height:2px;background:#cbd5e1;border-radius:999px}
  .puck{position:absolute;top:calc(50% - 10px);width:20px;height:20px;border-radius:50%;background:rgba(34,211,238,.25);border:1px solid rgba(34,211,238,.9);box-shadow:0 0 16px rgba(34,211,238,.5)}
  .bar{position:absolute;left:20px;right:20px;bottom:24px;height:10px;border-radius:999px;background:rgba(255,255,255,.08);overflow:hidden}
  .fill{position:absolute;left:50%;top:0;bottom:0;border-radius:999px;background:linear-gradient(90deg,#22d3ee,#22c55e);box-shadow:0 0 24px rgba(34,211,238,.5)}
  .bigNum{position:absolute;right:16px;top:12px;font:600 42px ui-monospace, SFMono-Regular, Menlo, Monaco, monospace}
  .label{position:absolute;left:16px;top:12px;font-size:12px;letter-spacing:.08em;opacity:.85;text-transform:uppercase;display:flex;gap:8px;align-items:center}
  .icon{width:16px;height:16px;stroke:currentColor;stroke-width:2;fill:none;opacity:.9}
  .dial{position:relative;aspect-ratio:1/1;border-radius:18px;background:radial-gradient(800px 600px at 50% 30%, #0f1624 0%, #0b0f16 60%, transparent 100%);overflow:hidden}
  .dial svg{position:absolute;inset:0}
  .dial .num{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);font:600 42px ui-monospace, SFMono-Regular, Menlo, Monaco, monospace}
  /* ---------- THEME 2: APPLE (glass, dual circular) ---------- */
  .t-apple{--bg:#0b0c10;--fg:#f5f7fa;--muted:#a8b0bd;background:radial-gradient(1200px 900px at 50% -20%, #141823 0%, #0b0c10 55%, #0a0b10 100%); color:var(--fg);}
  .apple-wrap{min-height:100%; padding-top:56px;}
  .apple-grid{display:grid; grid-template-columns:1fr 1fr; gap:18px; padding:20px}
  @media(max-width:900px){ .apple-grid{grid-template-columns:1fr} }
  .glass{border-radius:24px;padding:18px;background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));border:1px solid rgba(255,255,255,.12);backdrop-filter:saturate(1.6) blur(14px);box-shadow:0 10px 40px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.06)}
  .title{font-size:13px;color:var(--muted);margin-bottom:8px;letter-spacing:.12em;text-transform:uppercase}
  .gauge{position:relative;aspect-ratio:1/1;border-radius:28px;background:radial-gradient(900px 700px at 50% 30%, #0f1218 0%, #0c0f15 60%, #0b0c10 100%);box-shadow:inset 0 0 0 1px rgba(255,255,255,.04), inset 0 8px 40px rgba(0,0,0,.6)}
  .center{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);text-align:center;user-select:none}
  .num{font:600 44px ui-monospace, SFMono-Regular, Menlo, Monaco, monospace}
  /* ---------- THEME 3: ISUZU (rugged, panels, orange) ---------- */
  .t-isuzu{--bg:#0c0b0b;--fg:#f3f4f6;--muted:#c4bdb6;--accent:#ff3b00;--warn:#ffb703;--red:#ef233c;
           background:linear-gradient(180deg,#0f0e0e,#050505); color:var(--fg);}
  .isuzu-wrap{min-height:100%; padding-top:56px;}
  .panel{border:1px solid #2b2b2b;border-radius:12px;background:#0a0a0a;box-shadow:inset 0 2px 0 rgba(255,255,255,.04), 0 4px 30px rgba(0,0,0,.5);padding:14px}
  .isuzu-grid{display:grid;grid-template-columns:1fr 1fr;gap:14px;padding:16px}
  @media(max-width:900px){ .isuzu-grid{grid-template-columns:1fr} }
  .segBar{display:grid;grid-template-columns:repeat(30,1fr);gap:2px;height:16px;background:#111;padding:4px;border-radius:8px;border:1px solid #2b2b2b}
  .seg{background:#1a1a1a;border-radius:3px}
  .seg.on{background:linear-gradient(#ff7a00,#ff3b00);box-shadow:0 0 8px rgba(255,80,0,.6)}
  .led{font:700 40px ui-monospace, SFMono-Regular, Menlo, Monaco, monospace;letter-spacing:.02em}
  .badge{font-size:11px;color:var(--muted);text-transform:uppercase;letter-spacing:.12em}
  .isuzu-title{display:flex;align-items:center;gap:8px}
  .isuzu-icon{width:16px;height:16px;stroke:var(--accent);stroke-width:2;fill:none}
  /* ---------- THEME 4: METAL (skeuomorphic) ---------- */
  .t-metal{--bg:#0b0b0c;--fg:#f5f7fa;--muted:#bfc6cf;background:radial-gradient(1400px 1000px at 50% -20%, #1a1b1e 0%, #0b0b0c 55%, #090a0e 100%); color:var(--fg);}
  .metal-wrap{min-height:100%; padding-top:56px;}
  .bezel{position:relative;aspect-ratio:1/1; border-radius:50%; background: conic-gradient(from 0deg, #bbb, #666, #bbb); box-shadow: inset 0 4px 10px rgba(255,255,255,.4), inset 0 -8px 18px rgba(0,0,0,.6), 0 20px 60px rgba(0,0,0,.5);}
  .bezel::before{content:\"\"; position:absolute; inset:12px; border-radius:50%; background: radial-gradient(600px 600px at 50% 40%, #0e0f12 0%, #0c0d10 60%, #0b0b0c 100%); box-shadow: inset 0 0 0 1px rgba(255,255,255,.06);}
  .metal-grid{display:grid; grid-template-columns:1fr 1fr; gap:22px; padding:20px}
  @media(max-width:900px){ .metal-grid{grid-template-columns:1fr} }
  .metal-center{position:absolute; left:50%; top:50%; transform:translate(-50%,-50%); text-align:center}
  .metal-num{font:700 44px ui-monospace, SFMono-Regular, Menlo, Monaco, monospace; text-shadow:0 0 10px rgba(255,255,255,.2)}
  .tick{position:absolute; left:0; top:0; right:0; bottom:0}
  .title2{font-size:13px; color:var(--muted); margin:8px 20px 0; letter-spacing:.12em; text-transform:uppercase}
</style>
</head>
<body class="t-free">
  <div class="topbar">
    <button class="pill" id="themeFree" title="Fri stil">Fri</button>
    <button class="pill" id="themeApple" title="Apple-inspirerad">Apple</button>
    <button class="pill" id="themeIsuzu" title="Isuzu-inspirerad">Isuzu</button>
    <button class="pill" id="themeMetal" title="Modern metall">Metall</button>
    <span class="pill hint">Tryck Starta för sensorer</span>
  </div>

  <!-- THEME 1: FREE -->
  <div id="wrap-free" class="free-wrap">
    <div class="free-main">
      <div class="free-card">
        <div class="barBox" id="freePitchBox">
          <div class="label"><svg class="icon" viewBox="0 0 24 24"><path d="M3 12h18M12 5l5 5M12 19l5-5"/></svg>Pitch • fram/bak</div>
          <div id="freePitchNum" class="bigNum">0.0°</div>
          <div class="hTrack" id="freePitchTrack"></div>
          <div class="puck" id="freePitchPuck"></div>
          <div class="bar"><div class="fill" id="freePitchFill" style="width:0%"></div></div>
        </div>
      </div>
      <div class="free-card">
        <div class="dial">
          <svg viewBox="0 0 100 100">
            <defs>
              <filter id="gfree"><feGaussianBlur stdDeviation="1.2" result="b"/><feMerge><feMergeNode in="b"/><feMergeNode in="SourceGraphic"/></feMerge></filter>
            </defs>
            <g id="freeRollTicks"></g>
            <g id="freeRollH" filter="url(#gfree)">
              <line x1="12" x2="88" y1="50" y2="50" stroke="#cbd5e1" stroke-width="0.8" stroke-linecap="round"/>
            </g>
            <g id="freeRollSweep" filter="url(#gfree)"></g>
          </svg>
          <div id="freeRollNum" class="num">0.0°</div>
        </div>
      </div>
    </div>
  </div>

  <!-- THEME 2: APPLE -->
  <div id="wrap-apple" class="apple-wrap" hidden>
    <div class="glass">
      <div class="title">Mätare</div>
      <div class="apple-grid">
        <div class="gauge">
          <svg viewBox="0 0 100 100">
            <defs>
              <linearGradient id="ringGrad" x1="0" y1="0" x2="0" y2="1">
                <stop offset="0%" stop-color="rgba(255,255,255,.85)"/>
                <stop offset="100%" stop-color="rgba(255,255,255,.12)"/>
              </linearGradient>
              <filter id="softGlow">
                <feGaussianBlur stdDeviation="1.5" result="b"/>
                <feMerge><feMergeNode in="b"/><feMergeNode in="SourceGraphic"/></feMerge>
              </filter>
            </defs>
            <circle cx="50" cy="50" r="46" fill="none" stroke="url(#ringGrad)" stroke-width="0.5"/>
            <g id="applePitchArcs"></g>
            <g id="applePitchTicks"></g>
            <g id="applePitchH" filter="url(#softGlow)"><line x1="14" x2="86" y1="50" y2="50" stroke="#cbd5e1" stroke-width="0.6" stroke-linecap="round"/></g>
            <g id="applePitchSweep" filter="url(#softGlow)"></g>
          </svg>
          <div class="center">
            <div id="applePitchNum" class="num">0.0°</div>
            <div class="hint">Pitch • fram/bak</div>
          </div>
        </div>
        <div class="gauge">
          <svg viewBox="0 0 100 100">
            <circle cx="50" cy="50" r="46" fill="none" stroke="url(#ringGrad)" stroke-width="0.5"/>
            <g id="appleRollArcs"></g>
            <g id="appleRollTicks"></g>
            <g id="appleRollH" filter="url(#softGlow)"><line x1="14" x2="86" y1="50" y2="50" stroke="#cbd5e1" stroke-width="0.6" stroke-linecap="round"/></g>
            <g id="appleRollSweep" filter="url(#softGlow)"></g>
          </svg>
          <div class="center">
            <div id="appleRollNum" class="num">0.0°</div>
            <div class="hint">Roll • sidolutning</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- THEME 3: ISUZU -->
  <div id="wrap-isuzu" class="isuzu-wrap" hidden>
    <div class="isuzu-grid">
      <div class="panel">
        <div class="isuzu-title"><svg class="isuzu-icon" viewBox="0 0 24 24"><path d="M3 12h18M12 5l5 5M12 19l5-5"/></svg><span class="badge">Pitch • fram/bak</span></div>
        <div style="display:flex;justify-content:space-between;align-items:center;margin-top:8px">
          <div id="isuzuPitchNum" class="led">0.0°</div>
        </div>
        <div id="isuzuPitchSeg" class="segBar" style="margin-top:8px"></div>
      </div>
      <div class="panel">
        <div class="isuzu-title"><svg class="isuzu-icon" viewBox="0 0 24 24"><path d="M12 3v18M5 12l5-5M19 12l-5-5"/></svg><span class="badge">Roll • sidolutning</span></div>
        <div style="display:flex;justify-content:space-between;align-items:center;margin-top:8px">
          <div id="isuzuRollNum" class="led">0.0°</div>
        </div>
        <div id="isuzuRollSeg" class="segBar" style="margin-top:8px"></div>
      </div>
    </div>
  </div>

  <!-- THEME 4: METAL -->
  <div id="wrap-metal" class="metal-wrap" hidden>
    <div class="title2">Mätare</div>
    <div class="metal-grid">
      <div class="bezel">
        <svg class="tick" viewBox="0 0 100 100">
          <g id="metalPitchTicks"></g>
          <g id="metalPitchH"><line x1="14" x2="86" y1="50" y2="50" stroke="#d1d5db" stroke-width="0.8" stroke-linecap="round"/></g>
          <g id="metalPitchSweep"></g>
        </svg>
        <div class="metal-center">
          <div id="metalPitchNum" class="metal-num">0.0°</div>
          <div class="hint">Pitch • fram/bak</div>
        </div>
      </div>
      <div class="bezel">
        <svg class="tick" viewBox="0 0 100 100">
          <g id="metalRollTicks"></g>
          <g id="metalRollH"><line x1="14" x2="86" y1="50" y2="50" stroke="#d1d5db" stroke-width="0.8" stroke-linecap="round"/></g>
          <g id="metalRollSweep"></g>
        </svg>
        <div class="metal-center">
          <div id="metalRollNum" class="metal-num">0.0°</div>
          <div class="hint">Roll • sidolutning</div>
        </div>
      </div>
    </div>
  </div>

  <div class="controls">
    <button id="startBtn" class="btn">Starta</button>
    <button id="stopBtn" class="btn" style="display:none">Stoppa</button>
  </div>

<script>
(function(){
  const clamp=(v,min,max)=>Math.max(min,Math.min(max,v));
  const toFixed=(v,n=1)=>Number.isFinite(v)?v.toFixed(n):"—";
  const rollWarn=20, rollRed=30, pitchWarn=25, pitchRed=35;
  let rawRoll=0, rawPitch=0, roll=0, pitch=0, rollZero=0, pitchZero=0, alpha=0.15, raf;
  let theme='free';

  // --- helpers for drawing ---
  function drawTicks(groupId, max=45, color='rgba(255,255,255,.55)'){
    const g=document.getElementById(groupId); if(!g) return; g.innerHTML="";
    for(let a=-max;a<=max;a+=5){
      const len=(a%10===0)?3:2, r=44.5;
      const rad=(a-90)*Math.PI/180;
      const x1=50 + Math.cos(rad)*r, y1=50 + Math.sin(rad)*r;
      const x2=50 + Math.cos(rad)*(r-len), y2=50 + Math.sin(rad)*(r-len);
      const line=document.createElementNS('http://www.w3.org/2000/svg','line');
      line.setAttribute('x1',x1); line.setAttribute('y1',y1);
      line.setAttribute('x2',x2); line.setAttribute('y2',y2);
      line.setAttribute('stroke',color); line.setAttribute('stroke-width','0.6');
      g.appendChild(line);
      if(a%10===0){
        const tx=50 + Math.cos(rad)*(r-6), ty=50 + Math.sin(rad)*(r-6);
        const text=document.createElementNS('http://www.w3.org/2000/svg','text');
        text.setAttribute('x',tx); text.setAttribute('y',ty);
        text.setAttribute('text-anchor','middle'); text.setAttribute('dominant-baseline','middle');
        text.setAttribute('fill',color); text.setAttribute('font-size','3.6');
        text.textContent=String(Math.abs(a));
        g.appendChild(text);
      }
    }
  }
  function setRotate(groupId, deg){
    const g=document.getElementById(groupId); if(g) g.setAttribute('transform',`rotate(${deg} 50 50)`);
  }
  function setSweep(groupId, deg, color='#22d3ee'){
    const g=document.getElementById(groupId); if(!g) return;
    const len=8, r=44;
    const from=(deg-len/2-90)*Math.PI/180, to=(deg+len/2-90)*Math.PI/180;
    const x1=50 + Math.cos(from)*r, y1=50 + Math.sin(from)*r;
    const x2=50 + Math.cos(to)*r, y2=50 + Math.sin(to)*r;
    g.innerHTML="";
    const path=document.createElementNS('http://www.w3.org/2000/svg','path');
    path.setAttribute('d',`M ${x1} ${y1} A ${r} ${r} 0 0 1 ${x2} ${y2}`);
    path.setAttribute('fill','none'); path.setAttribute('stroke',color); path.setAttribute('stroke-width','3.2'); path.setAttribute('stroke-linecap','round'); path.setAttribute('opacity','.95');
    g.appendChild(path);
  }
  function setSegBar(containerId, valueDeg, max=30){
    const wrap=document.getElementById(containerId); if(!wrap) return;
    if(!wrap.dataset.built){
      wrap.innerHTML=''; for(let i=0;i<30;i++){ const d=document.createElement('div'); d.className='seg'; wrap.appendChild(d); }
      wrap.dataset.built='1';
    }
    const nodes=wrap.querySelectorAll('.seg');
    const nOn = Math.round(clamp((Math.abs(valueDeg)/max),0,1)*nodes.length);
    nodes.forEach((el,i)=>{ el.classList.toggle('on', i < nOn); });
  }

  // initial decorations
  drawTicks('freeRollTicks');
  drawTicks('applePitchTicks'); drawTicks('appleRollTicks');
  drawTicks('metalPitchTicks','#e5e7eb'); drawTicks('metalRollTicks','#e5e7eb');

  function update(){
    const pr=rawRoll - rollZero, pp=rawPitch - pitchZero;
    roll = roll + alpha*(pr - roll);
    pitch = pitch + alpha*(pp - pitch);

    // --- FREE updates ---
    if(theme==='free'){
      const box=document.getElementById('freePitchBox').getBoundingClientRect();
      const left=20, right=box.width-20, mid=left + (right-left)/2;
      const span=right-left; const maxDeg=30;
      const x = mid + clamp((pitch/maxDeg), -1, 1)*(span/2 - 10);
      const puck=document.getElementById('freePitchPuck');
      puck.style.left=(x)+'px';
      document.getElementById('freePitchNum').textContent=toFixed(pitch,1)+'°';
      document.getElementById('freeRollNum').textContent=toFixed(roll,1)+'°';
      setRotate('freeRollH', roll);
      setSweep('freeRollSweep', roll, '#22d3ee');
      const fill=document.getElementById('freePitchFill');
      const percent = clamp((pitch/30),-1,1)*50;
      if(percent>=0){ fill.style.left='50%'; fill.style.width=percent+'%'; }
      else { fill.style.left=(50+percent)+'%'; fill.style.width=(-percent)+'%'; }
      const cPitch = Math.abs(pitch)>=35 ? '#ef4444AA' : Math.abs(pitch)>=25 ? '#facc1588' : '#22d3ee';
      puck.style.borderColor=cPitch; puck.style.boxShadow=`0 0 16px ${cPitch}`;
    }

    // --- APPLE updates ---
    if(theme==='apple'){
      document.getElementById('applePitchNum').textContent=toFixed(pitch,1)+'°';
      document.getElementById('appleRollNum').textContent=toFixed(roll,1)+'°';
      setRotate('applePitchH', pitch);
      setRotate('appleRollH', roll);
      setSweep('applePitchSweep', pitch, '#7dd3fc');
      setSweep('appleRollSweep', roll, '#7dd3fc');
    }

    // --- ISUZU updates ---
    if(theme==='isuzu'){
      document.getElementById('isuzuPitchNum').textContent=toFixed(pitch,1)+'°';
      document.getElementById('isuzuRollNum').textContent=toFixed(roll,1)+'°';
      setSegBar('isuzuPitchSeg', pitch, 30);
      setSegBar('isuzuRollSeg', roll, 30);
    }

    // --- METAL updates ---
    if(theme==='metal'){
      document.getElementById('metalPitchNum').textContent=toFixed(pitch,1)+'°';
      document.getElementById('metalRollNum').textContent=toFixed(roll,1)+'°';
      setRotate('metalPitchH', pitch);
      setRotate('metalRollH', roll);
      setSweep('metalPitchSweep', pitch, '#e5e7eb');
      setSweep('metalRollSweep', roll, '#e5e7eb');
    }
  }
  function loop(){ update(); raf=requestAnimationFrame(loop); }

  function handleOrientation(e){
    const beta=clamp((e.beta??0), -90, 90);
    const gamma=clamp((e.gamma??0), -90, 90);
    rawPitch=beta; rawRoll=gamma;
  }
  async function start(){
    if (typeof DeviceOrientationEvent!=='undefined' && typeof DeviceOrientationEvent.requestPermission==='function'){
      const perm=await DeviceOrientationEvent.requestPermission();
      if(perm!=='granted') return;
    }
    window.addEventListener('deviceorientation', handleOrientation, {passive:true});
    document.getElementById('startBtn').style.display='none';
    document.getElementById('stopBtn').style.display='inline-block';
    loop();
  }
  function stop(){
    window.removeEventListener('deviceorientation', handleOrientation);
    document.getElementById('stopBtn').style.display='none';
    document.getElementById('startBtn').style.display='inline-block';
    cancelAnimationFrame(raf);
  }

  // theme switching
  function showTheme(t){
    theme=t;
    document.body.className = t==='free' ? 't-free' : t==='apple' ? 't-apple' : t==='isuzu' ? 't-isuzu' : 't-metal';
    document.getElementById('wrap-free').hidden = t!=='free';
    document.getElementById('wrap-apple').hidden = t!=='apple';
    document.getElementById('wrap-isuzu').hidden = t!=='isuzu';
    document.getElementById('wrap-metal').hidden = t!=='metal';
  }

  document.getElementById('themeFree').addEventListener('click', ()=>showTheme('free'));
  document.getElementById('themeApple').addEventListener('click', ()=>showTheme('apple'));
  document.getElementById('themeIsuzu').addEventListener('click', ()=>showTheme('isuzu'));
  document.getElementById('themeMetal').addEventListener('click', ()=>showTheme('metal'));
  document.getElementById('startBtn').addEventListener('click', start);
  document.getElementById('stopBtn').addEventListener('click', stop);

  // build segmented bars once for isuzu
  setSegBar('isuzuPitchSeg', 0); setSegBar('isuzuRollSeg', 0);

  // done
  showTheme('free');
})();
</script>
</body>
</html>
